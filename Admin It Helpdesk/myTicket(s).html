<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Tickets - IT-HelpDesk</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Remove any unwanted borders from dropdown menus */
      .sidebar .nav-item.dropdown .submenu-sidebar,
      .sidebar .submenu-sidebar li,
      .sidebar .submenu-sidebar li a,
      .sidebar .dropdown-submenu .sub-submenu {
        border: none !important;
        border-left: none !important;
        border-right: none !important;
        border-top: none !important;
        border-bottom: none !important;
      }

      /* Remove horizontal lines above Admin Menu and Statistic */
      .sidebar .nav-item:nth-child(4),
      .sidebar .nav-item:nth-child(5) {
        border-top: none !important;
        box-shadow: none !important;
        background-image: none !important;
      }

      .sidebar .nav-item:nth-child(4)::before,
      .sidebar .nav-item:nth-child(5)::before,
      .sidebar .nav-item:nth-child(4)::after,
      .sidebar .nav-item:nth-child(5)::after {
        display: none !important;
        border: none !important;
        background: none !important;
      }

      /* Remove any potential dividers */
      .sidebar hr,
      .sidebar .divider {
        display: none !important;
      }

      /* Force remove all borders */
      .sidebar * {
        border-top: none !important;
        border-bottom: none !important;
      }

      /* Dashboard card styles for proper icon display */
      .dashboard-card {
        position: relative;
        text-align: left;
        padding: 20px 20px 20px 30px;
        height: 150px;
        width: 100%;
        min-width: 240px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        overflow: hidden;
      }

      /* Dashboard cards container */
      .dashboard-cards-container {
        margin-right: -10px;
        margin-left: -10px;
      }

      .dashboard-cards-container > div {
        padding-right: 10px;
        padding-left: 10px;
      }

      /* Responsive layout for cards */
      @media (max-width: 1200px) {
        .dashboard-cards-container {
          justify-content: space-around !important;
        }
      }

      @media (max-width: 991px) {
        .dashboard-cards-container > div {
          width: 50%;
        }
      }

      @media (max-width: 767px) {
        .dashboard-cards-container > div {
          width: 100%;
          max-width: 350px;
          margin-left: auto;
          margin-right: auto;
        }
      }

      .dashboard-card .number {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 2px;
        color: #5e5873;
      }

      .dashboard-card .description {
        font-size: 15px;
        font-weight: 600;
        color: #6e6b7b;
        margin-bottom: 2px;
      }

      .dashboard-card .sub-description {
        font-size: 12px;
        color: #b9b9c3;
      }

      /* Fixed icon position */
      .dashboard-card .icon {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        position: absolute;
        top: 50%;
        right: 30px;
        transform: translateY(-50%);
      }

      /* Filter styles to ensure visibility */
      .filter-btn {
        cursor: pointer;
        position: relative;
        padding: 8px;
        background-color: #f8f9fa;
        border-radius: 5px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .filter-modal {
        position: absolute;
        top: 40px;
        left: 0;
        width: 280px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        padding: 15px;
        z-index: 1000;
        display: none;
      }

      .filter-modal.active {
        display: block;
      }

      .filter-options {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 15px;
      }

      .filter-option {
        padding: 6px 12px;
        background-color: #f8f9fa;
        border-radius: 20px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .filter-option:hover {
        background-color: #e9ecef;
      }

      .filter-option.active {
        background-color: #4285f4;
        color: white;
      }

      .filter-select {
        margin-bottom: 15px;
      }

      .filter-select select {
        width: 100%;
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #ced4da;
        margin-top: 5px;
      }

      .filter-notes {
        font-size: 12px;
        color: #6c757d;
        margin-bottom: 15px;
      }

      .filter-button {
        width: 100%;
        padding: 8px;
        background-color: #4285f4;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .filter-button:hover {
        background-color: #3367d6;
      }

      /* Orange button styling */
      .btn-orange {
        background-color: #ff7a5a;
        color: white;
        border: none;
        border-radius: 25px;
        padding: 8px 20px;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.3s ease;
        width: auto;
        text-align: center;
      }

      .btn-orange:hover {
        background-color: #ff6540;
        box-shadow: 0 4px 8px rgba(255, 122, 90, 0.3);
      }

      /* New ticket container */
      .new-ticket-container {
        display: flex;
        justify-content: flex-start;
        margin-top: 10px;
      }

      .new-ticket-btn {
        width: 280px;
      }
    </style>
  </head>
  <body>
    <!-- Header container -->
    <div id="header-container"></div>

    <!-- Sidebar container -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <div class="main-content">
      <h2 class="mb-4">My Tickets</h2>

      <!-- Success Notification (Hidden by default) -->
      <div
        id="notification-alert"
        class="alert alert-success alert-dismissible fade show mb-4 d-none"
        role="alert"
        style="border-radius: 15px; border-left: 4px solid #28a745"
      >
        <div class="d-flex align-items-center">
          <div
            class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center me-3"
            style="width: 36px; height: 36px"
          >
            <i class="fas fa-check"></i>
          </div>
          <div>
            <strong>Pesan Dikirim</strong>
            <p class="mb-0" id="notification-message">
              Pesan Anda telah terkirim. Kami akan segera menghubungi Anda
              kembali.
            </p>
          </div>
        </div>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
          onclick="localStorage.removeItem('showTicketNotification'); localStorage.removeItem('ticketNotificationMessage');"
        ></button>
      </div>

      <!-- Dashboard Cards -->
      <div
        class="row g-3 dashboard-cards-container d-flex justify-content-between"
      >
        <!-- Open Tickets -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 mb-4">
          <div class="dashboard-card open-tickets">
            <div class="icon open-tickets">
              <i class="fa-duotone fa-solid fa-ticket"></i>
            </div>
            <div class="number">5</div>
            <div class="description">Open Ticket(s)</div>
            <div class="sub-description">5 Ticket(s) yang Open</div>
          </div>
        </div>

        <!-- In Progress Tickets -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 mb-4">
          <div class="dashboard-card progress-tickets">
            <div class="icon progress-tickets">
              <i class="fas fa-clock"></i>
            </div>
            <div class="number">2</div>
            <div class="description">Total On Progress</div>
            <div class="sub-description">2 Ticket(s) yang On Progress</div>
          </div>
        </div>

        <!-- Expired Tickets -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 mb-4">
          <div class="dashboard-card expired-tickets">
            <div class="icon expired-tickets">
              <i class="fa-solid fa-circle-xmark"></i>
            </div>
            <div class="number">456</div>
            <div class="description">Expired Ticket(s)</div>
            <div class="sub-description">456 Ticket(s) yang Expired</div>
          </div>
        </div>

        <!-- Total Tickets -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 mb-4">
          <div class="dashboard-card total-tickets">
            <div class="icon total-tickets">
              <i class="far fa-file-alt"></i>
            </div>
            <div class="number">10.555</div>
            <div class="description">Total Ticket(s)</div>
            <div class="sub-description">10.555 Ticket(s) dibuat</div>
          </div>
        </div>
      </div>

      <!-- Create New Ticket -->
      <div class="make-new-ticket mt-4">
        <h5>Make A New Tickets :</h5>
        <div class="new-ticket-container">
          <button
            class="btn btn-orange new-ticket-btn"
            onclick="window.location.href='newProblemTicket.html'"
          >
            Click here to report your problem
          </button>
        </div>
      </div>

      <!-- Ticket List -->
      <div class="ticket-list">
        <h5 class="mb-3">My Ticket(s) List</h5>
        <div
          class="ticket-list-header d-flex justify-content-between align-items-center"
        >
          <div class="d-flex align-items-center">
            <div
              class="filter-btn me-3"
              id="filter-btn-ticket"
              style="position: relative"
            >
              <i class="fa-solid fa-sliders"></i>

              <!-- Filter Modal -->
              <div class="filter-modal" id="filter-modal-ticket">
                <h3>Select Ticket(s) Status</h3>

                <div class="filter-options">
                  <div class="filter-option">Open</div>
                  <div class="filter-option">On Progress</div>
                  <div class="filter-option">Expired</div>
                  <div class="filter-option">Solved</div>
                  <div class="filter-option">Show All</div>
                </div>

                <div class="filter-select">
                  <label for="filter-select-ticket">Show By :</label>
                  <select id="filter-select-ticket">
                    <option value="">Select</option>
                    <option value="date">Aplikasi</option>
                    <option value="department">Hardware</option>
                    <option value="priority">dan sebagainya</option>
                  </select>
                </div>

                <div class="filter-notes">
                  *You can choose multiple Tickets Status<br />
                  *You can choose the type of the Ticket(s)
                </div>

                <button class="filter-button">Select Now</button>
              </div>
            </div>
            <div class="search-bar me-3">
              <i class="fas fa-search"></i>
              <input type="text" placeholder="Search" />
            </div>
          </div>
          <div class="pagination">
            <a href="#" class="pagination-btn">&lt;</a>
            <a href="#" class="pagination-number active">1</a>
            <a href="#" class="pagination-number">2</a>
            <a href="#" class="pagination-number">3</a>
            <span class="pagination-dots">...</span>
            <a href="#" class="pagination-number">12</a>
            <a href="#" class="pagination-btn">&gt;</a>
          </div>
        </div>

        <!-- Filter Modal: Moved inside filter button container above -->

        <!-- Ticket Item -->
        <div class="ticket-item">
          <div class="ticket-header">
            <div class="ticket-title">
              <div class="ticket-status status-solved">
                <i class="fas fa-check"></i>
              </div>
              <div>
                <h4>Permohonan penembakan PB Built in weekend project</h4>
                <div class="ticket-id">PB0123456789</div>
              </div>
            </div>
            <div class="ticket-actions">
              <button class="btn btn-outline-secondary btn-sm" title="Print">
                <i class="fas fa-print"></i>
              </button>
              <button
                class="view-details-btn"
                onclick="window.location.href='viewDetail.html?id=PB0123456789&subject=Permohonan penembakan PB Built in weekend project&status=Solved'"
              >
                View Details
              </button>
            </div>
          </div>
          <div class="ticket-content">
            <p>
              Mohon untuk dilakukan penembakan pada PB Built in weekend project
              PB0123456789, agar shift editing bisa di tarik, dikarenakan
              terjadi kendala dalam pekerjaan shift editing padahal sudah
              approval dari postpro dan PCM, dengan detail PEPS sebagai berikut:
            </p>
            <p>PEPSB0123456789 (Shift)</p>
            <p>PEPSB0123456789 (Shift)</p>
            <p>Terimakasih</p>
          </div>
          <div class="ticket-tag solved">Solved By: John Newman</div>
          <div class="ticket-footer">
            <div class="row">
              <div class="col-md-4">
                <div class="footer-row">
                  <span class="footer-label">Reported By:</span>
                  <span class="footer-value">John Doe</span>
                </div>
                <div class="footer-row">
                  <span class="footer-label">Department:</span>
                  <span class="footer-value"
                    >IT Office - Aplikasi HR - HRSS (PMS, Cuti online, Legal
                    Online)</span
                  >
                </div>
              </div>
              <div class="col-md-4">
                <div class="footer-row">
                  <span class="footer-label">No. Ext/ Telp/ Cug:</span>
                  <span class="footer-value">0812345678</span>
                </div>
                <div class="footer-row">
                  <span class="footer-label">IP Address:</span>
                  <span class="footer-value">192.168.2.222</span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="footer-row">
                  <span class="footer-label">Date:</span>
                  <span class="footer-value">03 Maret 2025</span>
                </div>
                <div class="footer-row">
                  <span class="footer-label">Time:</span>
                  <span class="footer-value">15:00</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Additional ticket items would go here -->

        <!-- Bottom Pagination -->
        <div class="d-flex justify-content-end align-items-center mt-4">
          <div class="pagination">
            <a href="#" class="pagination-btn">&lt;</a>
            <a href="#" class="pagination-number active">1</a>
            <a href="#" class="pagination-number">2</a>
            <a href="#" class="pagination-number">3</a>
            <span class="pagination-dots">...</span>
            <a href="#" class="pagination-number">12</a>
            <a href="#" class="pagination-btn">&gt;</a>
          </div>
        </div>
      </div>
    </div>

    <!-- WhatsApp Button -->
    <a href="#" class="whatsapp-btn" title="Contact us on WhatsApp">
      <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Copyright Container -->
    <div id="copyright-container"></div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="utils.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Check if notification should be shown
        if (localStorage.getItem("showTicketNotification") === "true") {
          const notificationAlert =
            document.getElementById("notification-alert");
          const notificationMessage = document.getElementById(
            "notification-message"
          );

          // Set message if available
          if (localStorage.getItem("ticketNotificationMessage")) {
            notificationMessage.textContent = localStorage.getItem(
              "ticketNotificationMessage"
            );
          }

          // Show notification
          notificationAlert.classList.remove("d-none");

          // Clear after 5 seconds
          setTimeout(() => {
            notificationAlert.classList.add("d-none");
            localStorage.removeItem("showTicketNotification");
            localStorage.removeItem("ticketNotificationMessage");
          }, 5000);
        }

        // Filter Modal Toggle
        const filterBtn = document.getElementById("filter-btn-ticket");
        const filterModal = document.getElementById("filter-modal-ticket");

        if (filterBtn && filterModal) {
          filterBtn.addEventListener("click", function (e) {
            e.stopPropagation(); // Stop click from propagating to document
            filterModal.classList.toggle("active");
          });

          // Close the filter modal when clicking outside
          document.addEventListener("click", function (e) {
            if (
              !filterBtn.contains(e.target) &&
              !filterModal.contains(e.target)
            ) {
              filterModal.classList.remove("active");
            }
          });

          // Prevent clicks inside the filter modal from closing it
          filterModal.addEventListener("click", function (e) {
            e.stopPropagation();
          });

          // Handle filter options selection
          const filterOptions = filterModal.querySelectorAll(".filter-option");
          filterOptions.forEach((option) => {
            option.addEventListener("click", function () {
              // For "Show All" option, deselect all others when selected
              if (this.textContent === "Show All") {
                filterOptions.forEach((opt) => {
                  if (opt.textContent !== "Show All") {
                    opt.classList.remove("active");
                  }
                });
                this.classList.toggle("active");
              } else {
                // For other options, deselect "Show All" if it's active
                filterOptions.forEach((opt) => {
                  if (opt.textContent === "Show All") {
                    opt.classList.remove("active");
                  }
                });
                this.classList.toggle("active");
              }
            });
          });

          // Filter Button Action
          const filterButton = filterModal.querySelector(".filter-button");
          if (filterButton) {
            filterButton.addEventListener("click", function () {
              // Get selected statuses
              const selectedStatuses = [];
              filterOptions.forEach((option) => {
                if (option.classList.contains("active")) {
                  selectedStatuses.push(option.textContent);
                }
              });

              // Get selected "Show By" value
              const showByValue = document.getElementById(
                "filter-select-ticket"
              ).value;

              // Apply filters (this is where you'd implement actual filtering)
              console.log("Selected statuses:", selectedStatuses);
              console.log("Show by:", showByValue);

              // Close the modal
              filterModal.classList.remove("active");
            });
          }
        }
      });
    </script>
  </body>
</html>
