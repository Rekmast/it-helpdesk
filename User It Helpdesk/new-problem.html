<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IT-HelpDesk - Report New Problem</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Odor+Mean+Chey&display=swap"
      rel="stylesheet"
    />
    <script src="components-user.js"></script>
    <style>
      /* Device Details Styles */
      .details-toggle-container {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
      }

      .details-toggle-container label {
        margin-left: 10px;
        margin-bottom: 0;
        font-weight: 500;
      }

      #details-fields {
        display: none;
        padding-top: 5px;
      }

      #includeDeviceDetails {
        width: 18px;
        height: 18px;
      }

      [contenteditable="true"]:empty:before {
        content: attr(data-placeholder);
        color: #6c757d;
        font-style: italic;
      }

      /* Submit Button Style */
      #submit-btn {
        background-color: #0c416a;
        color: white;
        transition: background-color 0.2s;
      }

      #submit-btn:hover {
        background-color: #0a3559;
      }
    </style>
  </head>
  <body>
    <!-- Navigation Bar -->
    <div id="navbar-container"></div>

    <div class="container py-5">
      <div class="row">
        <div class="col-md-8">
          <h2 class="mb-4">New Problem Ticket</h2>

          <!-- Problem Ticket Form -->
          <div class="bg-white p-4 rounded shadow-sm">
            <form id="problem-ticket-form">
              <!-- Username Field -->
              <div class="mb-3">
                <label for="username" class="form-label">Username</label>
                <input
                  type="text"
                  class="form-control"
                  id="username"
                  placeholder="Enter username"
                  required
                />
              </div>

              <!-- No. Ext / No. Telp / CUG Field -->
              <div class="mb-3">
                <label for="contact-number" class="form-label"
                  >No. Ext / No. Telp / CUG*</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="contact-number"
                  placeholder="Enter number"
                  required
                />
              </div>

              <!-- Date Field -->
              <div class="mb-3">
                <label for="date" class="form-label">Date*</label>
                <input
                  type="text"
                  class="form-control"
                  id="date"
                  readonly
                  value=""
                />
              </div>

              <!-- IP User and IP Address Fields -->
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="ip-user" class="form-label">IP User</label>
                  <input
                    type="text"
                    class="form-control"
                    id="ip-user"
                    placeholder="Enter number"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="ip-address" class="form-label">IP Address</label>
                  <input
                    type="text"
                    class="form-control"
                    id="ip-address"
                    placeholder="Autofill"
                    readonly
                    value=""
                  />
                </div>
              </div>

              <!-- Department Field -->
              <div class="mb-3">
                <label for="department" class="form-label">Department</label>
                <select class="form-select" id="department" required>
                  <option value="" selected>Select Department</option>
                  <option value="option1">Department option 1</option>
                  <option value="option2">Department option 2</option>
                  <option value="option3">Department option</option>
                </select>
              </div>

              <!-- Category Field -->
              <div class="mb-3">
                <label for="category" class="form-label">Category</label>
                <select class="form-select" id="category" required>
                  <option value="" selected>Select Category</option>
                  <option value="option1">Category option</option>
                  <option value="option2">Category option 1</option>
                  <option value="option3">Category option 2</option>
                </select>
              </div>

              <!-- Device Details Section -->
              <div class="mb-3">
                <div class="details-toggle-container">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="includeDeviceDetails"
                  />
                  <label class="form-check-label" for="includeDeviceDetails">
                    Device Details (Optional)
                  </label>
                </div>

                <div id="details-fields">
                  <div class="row">
                    <div class="col-md-6 mb-2">
                      <label for="device-type" class="form-label"
                        >Device Type</label
                      >
                      <select class="form-select" id="device-type">
                        <option value="" selected>Select Device Type</option>
                        <option value="desktop">Desktop</option>
                        <option value="laptop">Laptop</option>
                        <option value="tablet">Tablet</option>
                        <option value="mobile">Mobile Phone</option>
                        <option value="printer">Printer</option>
                        <option value="server">Server</option>
                        <option value="network">Network Equipment</option>
                        <option value="other">Other</option>
                      </select>
                    </div>
                    <div class="col-md-6 mb-2">
                      <label for="device-brand" class="form-label">Brand</label>
                      <input
                        type="text"
                        class="form-control"
                        id="device-brand"
                        placeholder="Enter device brand"
                      />
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6 mb-2">
                      <label for="device-model" class="form-label">Model</label>
                      <input
                        type="text"
                        class="form-control"
                        id="device-model"
                        placeholder="Enter device model"
                      />
                    </div>
                    <div class="col-md-6 mb-2">
                      <label for="device-id" class="form-label"
                        >Device ID/Serial Number</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="device-id"
                        placeholder="Enter device ID or serial number"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <!-- Subject Field -->
              <div class="mb-3">
                <label for="subject" class="form-label">Subject*</label>
                <input
                  type="text"
                  class="form-control"
                  id="subject"
                  placeholder="Enter Subject"
                  required
                />
              </div>

              <!-- Description Field -->
              <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <div class="border rounded p-2">
                  <div class="btn-toolbar mb-2" role="toolbar">
                    <div class="btn-group me-2" role="group">
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-undo"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-redo"></i>
                      </button>
                    </div>
                    <div class="btn-group me-2" role="group">
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        Normal text
                      </button>
                    </div>
                    <div class="btn-group me-2" role="group">
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-list"></i>
                      </button>
                    </div>
                    <div class="btn-group" role="group">
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-bold"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-italic"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-underline"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-strikethrough"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-link"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-list-ol"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-list-ul"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-image"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-code"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                      >
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>

                  <div
                    contenteditable="true"
                    class="form-control"
                    style="min-height: 200px"
                    id="description-editor"
                    data-placeholder="Deskripsikan Masalahmu!"
                    required
                  ></div>
                </div>
              </div>

              <!-- Attachments -->
              <div class="mb-3">
                <div class="d-flex align-items-center mb-2">
                  <label class="form-label mb-0 me-3">Attachment 1</label>
                  <div class="input-group" style="max-width: 300px">
                    <button class="btn btn-secondary" type="button">
                      Choose File
                    </button>
                    <span class="form-control bg-light">No File Chosen</span>
                  </div>
                  <small class="ms-3 text-muted">jpeg, maks. 1 mb</small>
                </div>

                <div class="d-flex align-items-center mb-2">
                  <label class="form-label mb-0 me-3">Attachment 2</label>
                  <div class="input-group" style="max-width: 300px">
                    <button class="btn btn-secondary" type="button">
                      Choose File
                    </button>
                    <span class="form-control bg-light">No File Chosen</span>
                  </div>
                  <small class="ms-3 text-muted">jpeg, maks. 1 mb</small>
                </div>

                <div class="d-flex align-items-center">
                  <label class="form-label mb-0 me-3">Attachment 3</label>
                  <div class="input-group" style="max-width: 300px">
                    <button class="btn btn-secondary" type="button">
                      Choose File
                    </button>
                    <span class="form-control bg-light">No File Chosen</span>
                  </div>
                  <small class="ms-3 text-muted">jpeg, maks. 1 mb</small>
                </div>
              </div>

              <div class="mb-3">
                <small class="text-muted">*Wajib diisi</small>
                <br />
                <small class="text-muted"
                  >*Mohon cek email office atau list di My Problem secara
                  berkala untuk mengetahui status problem ticket anda.</small
                >
              </div>

              <!-- Form Buttons -->
              <div class="d-flex justify-content-end mt-4">
                <button type="submit" class="btn me-2 px-4" id="submit-btn">
                  Submit
                </button>
                <button type="reset" class="btn btn-outline-secondary px-4">
                  Clear
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Helper image section -->
        <div class="col-md-4 d-flex flex-column">
          <div class="text-center mb-3 pt-4">
            <!-- Video Tutorial Section -->
            <div class="bg-white p-3 rounded shadow-sm mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-video me-2"></i> Tutorial Video
              </h5>
              <div class="new-problem-video">
                <div class="play-overlay">
                  <div class="play-button">
                    <i
                      class="fas fa-play"
                      style="color: white; font-size: 24px"
                    ></i>
                  </div>
                </div>
              </div>
              <p class="mt-2 mb-0 small text-muted">
                Click to learn how to submit a ticket
              </p>
            </div>

            <!-- Need Assistance Section -->
            <div class="assistance-section mb-4">
              <h4 class="text-primary mb-3">Need Assistance?</h4>
              <p>
                Our IT support team is ready to help with your technical issues.
                Fill in the form and we'll get back to you shortly.
              </p>
              <div class="assistance-contact">
                <i class="fas fa-headset"></i>
                <p class="mb-0">
                  <strong>Contact:</strong> helpdesk@company.com
                </p>
              </div>
            </div>

            <!-- Image Section -->
            <div
              class="helper-image-section"
              style="padding: 10px; margin-bottom: 20px"
            >
              <img
                src="person2.png"
                alt="IT Support Slide"
                class="img-fluid shadow-sm"
                style="border-radius: 10px"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <!-- WhatsApp Button -->
    <div id="whatsapp-container"></div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Auto-fill the date field with current date
      document.addEventListener("DOMContentLoaded", function () {
        // Ensure navbar logo is loaded properly
        const navbarContainer = document.getElementById("navbar-container");
        if (navbarContainer) {
          setTimeout(() => {
            const logo = document.querySelector(".logo img");
            if (!logo) {
              // If logo isn't loaded, try reloading the component
              if (window.ITHelpdesk && window.ITHelpdesk.includeComponent) {
                window.ITHelpdesk.includeComponent(
                  "navbar-component",
                  "navbar-container"
                );
              }
            }
          }, 200);
        }

        const today = new Date();
        const formattedDate = today.toLocaleDateString("en-GB", {
          day: "2-digit",
          month: "long",
          year: "numeric",
        });
        document.getElementById("date").value = formattedDate;

        // Toggle details fields
        const detailsCheckbox = document.getElementById("includeDeviceDetails");
        const detailsFields = document.getElementById("details-fields");

        detailsCheckbox.addEventListener("change", function () {
          if (this.checked) {
            detailsFields.style.display = "block";
          } else {
            detailsFields.style.display = "none";
          }
        });

        // Form validation
        const form = document.querySelector("#problem-ticket-form");
        form.addEventListener("submit", function (event) {
          event.preventDefault();

          // Get form fields
          const username = document.getElementById("username").value;
          const contactNumber = document.getElementById("contact-number").value;
          const department = document.getElementById("department").value;
          const category = document.getElementById("category").value;
          const subject = document.getElementById("subject").value;
          const description =
            document.getElementById("description-editor").innerText;

          // Simple validation
          if (
            !username ||
            !contactNumber ||
            !department ||
            !category ||
            !subject ||
            !description
          ) {
            alert("Please fill out all required fields");
            return;
          }

          // Store notification flag for My Tickets page
          localStorage.setItem("showTicketNotification", "true");
          localStorage.setItem(
            "ticketNotificationMessage",
            "Problem ticket has been successfully submitted."
          );

          // Redirect to My Tickets page
          window.location.href = "mytickets.html";
        });
      });
    </script>
  </body>
</html>
